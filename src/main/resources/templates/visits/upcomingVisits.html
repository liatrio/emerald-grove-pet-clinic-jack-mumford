<!DOCTYPE html>

<html xmlns:th="https://www.thymeleaf.org"
  th:replace="~{fragments/layout :: layout (~{::body},'upcomingVisits')}">

<body>

  <section class="liatrio-section">
    <div class="liatrio-table-card">
      <div class="liatrio-card-header">
        <h2 th:text="#{upcomingVisits.title}">Upcoming Visits</h2>
        <p class="liatrio-muted" th:text="#{upcomingVisits.subtitle}">All scheduled future visits sorted chronologically</p>
      </div>

      <!-- Filter Form -->
      <form method="get" action="#" th:action="@{/visits/upcoming}" class="mb-4">
        <div class="row g-3">
          <div class="col-md-3">
            <label for="fromDate" class="form-label" th:text="#{upcomingVisits.filter.fromDate}">From Date</label>
            <input type="date" class="form-control" id="fromDate" name="fromDate"
              th:value="${param.fromDate}">
          </div>
          <div class="col-md-3">
            <label for="toDate" class="form-label" th:text="#{upcomingVisits.filter.toDate}">To Date</label>
            <input type="date" class="form-control" id="toDate" name="toDate"
              th:value="${param.toDate}">
          </div>
          <div class="col-md-3">
            <label for="petType" class="form-label" th:text="#{upcomingVisits.filter.petType}">Pet Type</label>
            <select class="form-select" id="petType" name="petType">
              <option value="" th:text="#{upcomingVisits.filter.petType.all}">All Types</option>
              <option th:each="type : ${petTypes}" th:value="${type.name}" th:text="${type.name}"
                th:selected="${param.petType != null and param.petType[0] == type.name}"></option>
            </select>
          </div>
          <div class="col-md-3">
            <label for="ownerLastName" class="form-label" th:text="#{upcomingVisits.filter.ownerName}">Owner Last Name</label>
            <input type="text" class="form-control" id="ownerLastName" name="ownerLastName"
              th:placeholder="#{upcomingVisits.filter.ownerName.placeholder}" th:value="${param.ownerLastName}">
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-12">
            <button type="submit" class="btn btn-primary" th:text="#{upcomingVisits.filter.apply}">Apply Filters</button>
            <a th:href="@{/visits/upcoming}" class="btn btn-secondary ms-2" th:text="#{upcomingVisits.filter.clear}">Clear Filters</a>
          </div>
        </div>
      </form>

      <div th:if="${#lists.isEmpty(visits)}" class="liatrio-empty-state">
        <p class="liatrio-muted" th:text="#{upcomingVisits.empty}">No upcoming visits scheduled</p>
      </div>

      <table th:unless="${#lists.isEmpty(visits)}" class="table table-striped liatrio-table table-responsive">
        <thead>
          <tr>
            <th th:text="#{upcomingVisits.column.visitDate}">Visit Date</th>
            <th th:text="#{upcomingVisits.column.petName}">Pet Name</th>
            <th th:text="#{upcomingVisits.column.ownerName}">Owner Name</th>
            <th th:text="#{upcomingVisits.column.description}">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="visit : ${visits}">
            <td th:text="${#temporals.format(visit.date, 'yyyy-MM-dd')}"></td>
            <td th:text="${visit.pet.name}"></td>
            <td th:text="${visit.pet.owner.firstName + ' ' + visit.pet.owner.lastName}"></td>
            <td th:text="${visit.description}"></td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

</body>

</html>
